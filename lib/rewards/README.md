Note: my guess is that doing this well is basically impossible. I'm keeping the code around out of (probably irrational) hope but I doubt anything will come of it.
